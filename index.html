<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>8th Wall Web: Portal</title>

    <!-- We've included a slightly modified version of A-Frame, which fixes some polish concerns -->
    <script src="//cdn.8thwall.com/web/aframe/8frame-0.8.2.min.js"></script>

    <!-- XR Extras - provides utilities like load screen, almost there, and error handling.
         See github.com/8thwall/web/xrextras -->
    <script src="//cdn.8thwall.com/web/xrextras/xrextras.js"></script>

    <!-- 8thWall Web - Replace the app key here with your own app key -->
    <script async
        src="//apps.8thwall.com/xrweb?appKey=vlLDoiv6su89laVSuJGEgA4XY7zCHTd9vkGGVuxGA84dhKpnK41fjiCsI5hYDg3sv43rVy"></script>

    <script>
        // register your component here with a name
        AFRAME.registerComponent('hello-world', {
            schema: {
                amount: {
                    type: 'number',
                    default: 10
                },
                color: {
                    type: 'color',
                    default: 'red'
                },
                duration: {
                    type: 'number',
                    default: 10000
                },
                randScaleMax: {
                    type: 'number',
                    default: 3
                },
            },
            //custom function
            getRandomInt: function (min, max) {
                min = Math.ceil(min);
                max = Math.floor(max);
                return Math.floor(Math.random() * (max - min)) + min; //The maximum is exclusive and the minimum is inclusive
            },
            getRandomColor: function () {
                var letters = '0123456789ABCDEF'.split('');
                var color = '#';
                for (var i = 0; i < 6; i++) {
                    color += letters[Math.floor(Math.random() * 16)];
                }
                return color;
            },
            init: function () {
                var box = document.createElement('a-sphere');
                box.setAttribute('shader-frog', "src:url(https://raw.githubusercontent.com/mhellar/aframestuff/gh-pages/basic4/shaders/sun.json)")
                box.setAttribute('position', 0 + ' ' + 6 + ' ' + 10);
                box.setAttribute('scale', '180 180 180');
                this.el.appendChild(box);
            }
        });


        AFRAME.registerComponent('circle', {
            schema: {
                type: 'string'
            },

            getRandomColor: function () {
                var letters = '0123456789ABCDEF'.split('');
                var color = '#';
                for (var i = 0; i < 6; i++) {
                    color += letters[Math.floor(Math.random() * 16)];
                }
                return color;
            },

            init: function () {
                let items = 32;
                for (var i = 0; i < items; i++) {

                    let x = 2 * Math.sin(2 * Math.PI * i / items);
                    let y = 2 * Math.cos(2 * Math.PI * i / items);
                    let z = 2 * Math.sin(2 * Math.PI * i / items);

                    let self = this;

                    var knot = document.createElement('a-torus-knot');
                    knot.setAttribute('color', this.getRandomColor());
                    knot.setAttribute('position', x + ' ' + y + ' ' + z);
                    knot.setAttribute('scale', '.1 .1 .1');
                    knot.setAttribute('rotation', x + ' ' + y + ' ' + z);
                    knot.setAttribute('metalness', Math.random());
                    knot.setAttribute('roughness', Math.random());
                    knot.setAttribute('radius', '30');

                    var anim = document.createElement('a-animation');
                    anim.setAttribute('attribute', 'scale');
                    anim.setAttribute('dur', '60000');
                    anim.setAttribute('to', z * 2 + ' ' + x * 2 + ' ' + y * 2);
                    anim.setAttribute('repeat', 'indefinite');
                    knot.appendChild(anim)

                    var anim = document.createElement('a-animation');
                    anim.setAttribute('attribute', 'rotation');
                    anim.setAttribute('dur', '60000');
                    anim.setAttribute('to', z + ' ' + x + ' ' + y);
                    anim.setAttribute('repeat', 'indefinite');
                    knot.appendChild(anim)

                    self.el.appendChild(knot);

                }

            }
        });
    </script>

</head>

<body>
    <a-scene xrweb portal xrextras-almost-there xrextras-loading xrextras-runtime-error xrextras-tap-recenter>

        <!-- We can define assets here to be loaded when A-Frame initializes -->
        <a-assets>
        </a-assets>

        <a-camera id="camera" position="0 5 8">
        </a-camera>

        <a-entity circle></a-entity>
    </a-scene>
</body>

</html>